[tox]
envlist = py27,py36,cov

[testenv]
# coverage can only find modules if pythonpath is set
setenv=
    PYTHONPATH={toxinidir}
    COVERAGE_FILE=.coverage.{envname}
deps=
    -rrequirements.txt
    pytest
    # cloudify-plugins-common==5.0.5.1
    cloudify==5.0.5.1
    coverage
    pytest-cov
whitelist_externals=
    /bin/mkdir
commands=
    mkdir -p logs
    coverage erase
    pytest --junitxml xunit-results.{envname}.xml --cov dcaepolicyplugin

[testenv:cov]
skip_install = true
deps=
    coverage
setenv=
    COVERAGE_FILE=.coverage
commands=
    coverage combine
    coverage xml

[pytest]
junit_family = xunit2
